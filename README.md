# MarketDataTool

Приложение для анализа межбиржевого арбитража
Общее описание
Приложение для анализа биржевого арбитража, т.е. сравнения цен на один и тот же
инструмент(например акцию) на разных биржах и выявление потенциала для
спекуляций.

Источник хотелось максимально "боевой" и что бы данные были intraday, остановился
на marketstack.com, у них есть определнное кол-во запросов по бесплатной подписке и
в теории очень много данных.

Сначала загружем сырую маркетдату через запросы REST-api, сохраняем
в хадуп в формате Parquet. Затем идет часть которая эмулирует потоки данных от разных бирж - данные в
несколько потоков вычитываются из хадупа и отправляются в кафку - для каждой биржы в свой топик 
(ничего не мешает тут в дальнейшем кидать в эти же топики паралельно данные с каких то других API 
по этой бирже - например более приближенных к real-time).

Далее идет основная часть - streaming-приложение, которое считывает данные из двух
топиков(приложений может быть запущено произвольное кол-во - сколько надо сравнивать бирж), 
обогащает данными по валютам торгов для полученных бирж и курсах этих валют. 
Приводит цены к одной валюте, срвнивает, вычисляет разницу в котировках.
Полученные данные отображаються в консоли онлайн, накапливаются в микробатчи и складываються в
итоговый топик kafka. На этот топик смотрит приложение, которое пишет результат в Postgress.

Батч-обработка запускается по запросу и вычисляет итоги за заданный промежуток времени:
максималльные/минимальные цены активов по заданными биржам, разница между ними. 
Предполагается что стриминговые данные
нам нужны только “онлайн” или близко к нему, а батчевые расчитываются для
пост-анализа).

Итого, если разбить по шагам (каждый модуль - отдельное приложение):
1. Получение сырых данных через внешний API, форматирование и сохранения в hadoop. - модуль **MainDataLoader**.
2. Вычитываем из hadoop в kafka по отдельным биржевым потокам. - модуль **MainProducer**.
3. Получаем сообщения из выбранных топиков в streaming-приложение,
сравниваем/обрабатываем, получаем результат в случае если есть разница в
цене актива между разными биржами(потоками). Результат отправляем в итоговый топик Kafka. - модуль **ArbitrageProcessing**.
4. Вычитываем из результирующего топика и сохраняем в Postgress. - модуль **PGWriter**.
5. Паральельная batch-обработка, которая средние/итоговые данные за период (вычитывает из hadoop, процессит и сохраняет в postgress). - модуль **ArbitrageBatch**.
